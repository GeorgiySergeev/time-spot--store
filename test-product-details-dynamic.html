<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Product Details Dynamic Rendering</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/swiper@8/swiper-bundle.min.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/glightbox@3.2.0/dist/css/glightbox.min.css" />
    <style>
      body {
        background-color: #f8f9fa;
        font-family: 'Arial', sans-serif;
      }
      .test-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }
      .test-section {
        background: white;
        border-radius: 8px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .product-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .product-card:hover {
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
      }
      .product-image {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-radius: 4px;
      }
      .btn-test {
        margin: 0.5rem;
      }
      .status {
        padding: 1rem;
        border-radius: 4px;
        margin: 1rem 0;
      }
      .status.success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .status.error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .status.info {
        background-color: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
    </style>
  </head>
  <body>
    <div class="test-container">
      <h1 class="text-center mb-4">Test Product Details Dynamic Rendering</h1>

      <!-- Test Controls -->
      <div class="test-section">
        <h3>Test Controls</h3>
        <div class="row">
          <div class="col-md-6">
            <h5>Test Product Cards</h5>
            <button
              class="btn btn-primary btn-test"
              onclick="testProductCards()">
              <i class="fas fa-eye"></i>
              Show Test Product Cards
            </button>
            <button
              class="btn btn-secondary btn-test"
              onclick="clearProducts()">
              <i class="fas fa-trash"></i>
              Clear Products
            </button>
          </div>
          <div class="col-md-6">
            <h5>Test Navigation</h5>
            <button class="btn btn-success btn-test" onclick="testNavigation()">
              <i class="fas fa-link"></i>
              Test Navigation to Details
            </button>
            <button class="btn btn-info btn-test" onclick="testDirectRender()">
              <i class="fas fa-cog"></i>
              Test Direct Render
            </button>
          </div>
        </div>
      </div>

      <!-- Status Display -->
      <div id="status" class="status info">
        <i class="fas fa-info-circle"></i>
        Ready to test. Click "Show Test Product Cards" to begin.
      </div>

      <!-- Product Cards Container -->
      <div class="test-section">
        <h3>Product Cards (Click to navigate to details)</h3>
        <div id="products" class="row">
          <!-- Product cards will be rendered here -->
        </div>
      </div>

      <!-- Test Product Details Page -->
      <div class="test-section">
        <h3>Product Details Page Preview</h3>
        <div class="alert alert-info">
          <i class="fas fa-info-circle"></i>
          This section shows how the product details page would look when
          rendered dynamically. Click on a product card above to see the
          navigation in action.
        </div>
        <div class="product-details-preview">
          <div class="row">
            <div class="col-md-6">
              <div class="card">
                <div class="card-header">
                  <h5>Main Product Image</h5>
                </div>
                <div class="card-body">
                  <div
                    class="swiper product-main-swiper"
                    id="product_page_slider">
                    <div class="swiper-wrapper">
                      <div class="swiper-slide">
                        <img
                          src="./img/products/2-450x450.jpg"
                          class="img-fluid"
                          alt="Product Image" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card">
                <div class="card-header">
                  <h5>Product Information</h5>
                </div>
                <div class="card-body">
                  <h4 id="product-name">Product Name</h4>
                  <p id="product-price">$299.00</p>
                  <p id="product-description">
                    Product description will be loaded dynamically...
                  </p>
                  <button class="btn btn-primary">Add to Cart</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Instructions -->
      <div class="test-section">
        <h3>How to Test</h3>
        <ol>
          <li>
            <strong>Show Test Product Cards:</strong>
            Renders sample product cards with click handlers
          </li>
          <li>
            <strong>Click on any product card:</strong>
            Should navigate to product-details.html with the product ID
          </li>
          <li>
            <strong>Test Navigation:</strong>
            Simulates clicking on a product card programmatically
          </li>
          <li>
            <strong>Test Direct Render:</strong>
            Tests the dynamic rendering functionality directly
          </li>
        </ol>

        <h4>Expected Behavior:</h4>
        <ul>
          <li>
            Product cards should be clickable and navigate to details page
          </li>
          <li>
            Product details page should load dynamically with the correct
            product data
          </li>
          <li>Thumbnail slider should work with multiple product images</li>
          <li>
            All product information should be populated from API or fallback
            data
          </li>
        </ul>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/glightbox@3.2.0/dist/js/glightbox.min.js"></script>

    <!-- Our modules -->
    <script type="module">
      import {
        renderProducts,
        getSampleProducts,
      } from './src/js/api/product-renderer.js'
      import {
        initializeProductCardHandlers,
        renderProductDetails,
      } from './src/js/api/product-details-dynamic-renderer.js'

      // Initialize product card handlers
      initializeProductCardHandlers()

      // Global functions for testing
      window.testProductCards = async () => {
        try {
          updateStatus('Loading test product cards...', 'info')
          const sampleProducts = getSampleProducts()
          renderProducts(sampleProducts, 'products', 'grid')
          updateStatus(
            'Test product cards loaded successfully! Click on any card to test navigation.',
            'success',
          )
        } catch (error) {
          updateStatus('Error loading product cards: ' + error.message, 'error')
        }
      }

      window.clearProducts = () => {
        document.getElementById('products').innerHTML = ''
        updateStatus('Products cleared.', 'info')
      }

      window.testNavigation = () => {
        updateStatus('Testing navigation to product details...', 'info')
        // Simulate clicking on first product
        const firstCard = document.querySelector('.single-product-area')
        if (firstCard) {
          const link = firstCard.querySelector('a[data-product-id]')
          if (link) {
            link.click()
          } else {
            updateStatus('No product card found to test navigation', 'error')
          }
        } else {
          updateStatus(
            'No product cards found. Please load test products first.',
            'error',
          )
        }
      }

      window.testDirectRender = async () => {
        try {
          updateStatus('Testing direct product details rendering...', 'info')
          const sampleProducts = getSampleProducts()
          const firstProduct = sampleProducts[0]

          // Update preview section
          document.getElementById('product-name').textContent =
            firstProduct.name
          document.getElementById('product-price').textContent =
            `$${firstProduct.price.toFixed(2)}`
          document.getElementById('product-description').textContent =
            firstProduct.description

          updateStatus(
            'Direct rendering test completed! Preview updated with sample data.',
            'success',
          )
        } catch (error) {
          updateStatus('Error in direct render test: ' + error.message, 'error')
        }
      }

      function updateStatus(message, type) {
        const statusEl = document.getElementById('status')
        statusEl.className = `status ${type}`
        statusEl.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'}"></i> ${message}`
      }

      // Initialize on page load
      document.addEventListener('DOMContentLoaded', () => {
        updateStatus(
          'Test page loaded. Ready to test product details dynamic rendering.',
          'info',
        )
      })
    </script>
  </body>
</html>
